@{
    ViewData["Title"] = "ایجاد گزارش جدید برای آمریت";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="content transport-content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <div class="card reports-card">
                    <div class="card-header fixed card-primary card-outline">
                        <div class="row">
                            <div class="col-md-6 row flexed-start-horizontal">
                                <div class="form-group col-md-5">
                                    <label>نوع زمانی گزارش</label>
                                    <select class="form-control select2-searchable bg-primary">
                                        <option value="">ماهانه</option>
                                        <option value="">سالانه</option>
                                    </select>
                                    <span class="text-danger"></span>
                                </div>
                                <div class="form-group col-md-5">
                                    <label>انتخاب ماه</label>
                                    <select class="form-control select2-searchable bg-primary">
                                        <option value="">حمل</option>
                                        <option value="">ثور</option>
                                        <option value="">جوزا</option>
                                        <option value="">سرطان</option>
                                        <option value="">اسد</option>
                                        <option value="">سنبله</option>
                                        <option value="">میزان</option>
                                        <option value="">عقرب</option>
                                        <option value="">قوس</option>
                                        <option value="">جدی</option>
                                        <option value="">دلو</option>
                                        <option value="">حوت</option>
                                    </select>
                                    <span class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6 row flexed-end-horizontal">
                                <div class="form-group">
                                    <label style="color: transparent">h</label>
                                    <button type="submit" id="btnSearch" class="btn btn-block btn-primary form-control"><i class="fa fa-file-text-o"></i> گزارش گیری</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0 table-responsive">
                        <table id="generalTable" class="table table-condensed doc-table">
                            <thead>
                                <tr>
                                    <th colspan="6">دسته بندی</th>
                                    <th colspan="4">تعداد کارهای انجام شده</th>
                                    <th colspan="2"></th>
                                </tr>
                            </thead>
                            <tbody id="generalTableBody">
                                <tr>
                                    <td colspan="5">
                                        <span class="list-item-titles"> فعالسازی و پشتیبانی انواع شبکه های داخلی تلفن، شیر فولدر و اینترنت دفاتر </span>
                                    </td>
                                    <td colspan="4">
                                        <span class="list-item-titles">
                                            122
                                        </span>
                                    </td>
                                    <td colspan="3">
                                        <div class="btn-group flexed-left-horizontal">
                                            <a type="button" class="btn hover-element-info background-lightblue" asp-action="SelectTasksForReport" asp-controller="PolicyDepartment">
                                                <i class="fa fa-eye"></i>
                                                مشاهده جزئیات
                                            </a>
                                            <a type="button" class="btn hover-element-info background-lightblue" href="#" data-toggle="modal" data-target="#ConfirmAllToIncludeInReportModal">
                                                تایید همه
                                                <i class="fa fa-check-circle"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5">
                                        <span class="list-item-titles"> فعالسازی و پشتیبانی انواع شبکه های داخلی تلفن، شیر فولدر و اینترنت دفاتر </span>
                                    </td>
                                    <td colspan="4">
                                        <span class="list-item-titles">
                                            122
                                        </span>
                                    </td>
                                    <td colspan="3">
                                        <div class="btn-group flexed-left-horizontal">
                                            <a type="button" class="btn hover-element-info background-lightblue" asp-action="SelectTasksForReport" asp-controller="PolicyDepartment">
                                                <i class="fa fa-eye"></i>
                                                مشاهده جزئیات
                                            </a>
                                            <a type="button" class="btn hover-element-info background-lightblue" href="#" data-toggle="modal" data-target="#ConfirmAllToIncludeInReportModal">
                                                تایید همه
                                                <i class="fa fa-check-circle"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5">
                                        <span class="list-item-titles"> فعالسازی و پشتیبانی انواع شبکه های داخلی تلفن، شیر فولدر و اینترنت دفاتر </span>
                                    </td>
                                    <td colspan="4">
                                        <span class="list-item-titles">
                                            122
                                        </span>
                                    </td>
                                    <td colspan="3">
                                        <div class="btn-group flexed-left-horizontal">
                                            <a type="button" class="btn hover-element-info background-lightblue" asp-action="SelectTasksForReport" asp-controller="PolicyDepartment">
                                                <i class="fa fa-eye"></i>
                                                مشاهده جزئیات
                                            </a>
                                            <a type="button" class="btn hover-element-info background-lightblue" href="#" data-toggle="modal" data-target="#ConfirmAllToIncludeInReportModal">
                                                تایید همه
                                                <i class="fa fa-check-circle"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5">
                                        <span class="list-item-titles"> فعالسازی و پشتیبانی انواع شبکه های داخلی تلفن، شیر فولدر و اینترنت دفاتر </span>
                                    </td>
                                    <td colspan="4">
                                        <span class="list-item-titles">
                                            122
                                        </span>
                                    </td>
                                    <td colspan="3">
                                        <div class="btn-group flexed-left-horizontal">
                                            <a type="button" class="btn hover-element-info background-lightblue" asp-action="SelectTasksForReport" asp-controller="PolicyDepartment">
                                                <i class="fa fa-eye"></i>
                                                مشاهده جزئیات
                                            </a>
                                            <a type="button" class="btn hover-element-info background-lightblue" href="#" data-toggle="modal" data-target="#ConfirmAllToIncludeInReportModal">
                                                تایید همه
                                                <i class="fa fa-check-circle"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5">
                                        <span class="list-item-titles"> فعالسازی و پشتیبانی انواع شبکه های داخلی تلفن، شیر فولدر و اینترنت دفاتر </span>
                                    </td>
                                    <td colspan="4">
                                        <span class="list-item-titles">
                                            122
                                        </span>
                                    </td>
                                    <td colspan="3">
                                        <div class="btn-group flexed-left-horizontal">
                                            <a type="button" class="btn hover-element-info background-lightblue" asp-action="SelectTasksForReport" asp-controller="PolicyDepartment">
                                                <i class="fa fa-eye"></i>
                                                مشاهده جزئیات
                                            </a>
                                            <a type="button" class="btn hover-element-info background-lightblue" href="#" data-toggle="modal" data-target="#ConfirmAllToIncludeInReportModal">
                                                تایید همه
                                                <i class="fa fa-check-circle"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="5">
                                        <span class="list-item-titles"> فعالسازی و پشتیبانی انواع شبکه های داخلی تلفن، شیر فولدر و اینترنت دفاتر </span>
                                    </td>
                                    <td colspan="4">
                                        <span class="list-item-titles">
                                            122
                                        </span>
                                    </td>
                                    <td colspan="3">
                                        <div class="btn-group flexed-left-horizontal">
                                            <a type="button" class="btn hover-element-info background-lightblue" asp-action="SelectTasksForReport" asp-controller="PolicyDepartment">
                                                <i class="fa fa-eye"></i>
                                                مشاهده جزئیات
                                            </a>
                                            <a type="button" class="btn hover-element-info background-lightblue" href="#" data-toggle="modal" data-target="#ConfirmAllToIncludeInReportModal">
                                                تایید همه
                                                <i class="fa fa-check-circle"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
             </div>
        </div>
    </div>
    <form id="createStaffReportForm" action="/Task/AddTodo" method="post">
        <div class="modal fade" id="createStaffReportModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">ثبت کار جدید</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="row">
                                <label for="Title" class="col-sm-3 col-form-label">عنوان وظیفه:</label>
                                <textarea class="form-control col-sm-7" placeholder="عنوان ..." name="Explanation"></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <label for="Title" class="col-sm-3 col-form-label">تاریخ:</label>
                                <input type="datetime-local" id="reportTitle" class="col-sm-7 form-control" name="Title">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <label for="staticEmail" class="col-sm-3 col-form-label">دسته بندی وظیفه: </label>
                                <div class="col-sm-7 none-padding-button">
                                    <a class=" btn-md dropdown-toggle todoType-dropdown-toggle" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <input type="text" class="form-control input-sm cursor-pointer todoTypeInputToDisplay" placeholder="نوع آیتم" readonly>
                                        <input type="hidden" class="todoTypeInputRealValue" name="TodoType">
                                    </a>
                                    <div class="dropdown-menu dropdown-menu-task-status">

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <label for="Title" class="col-sm-3 col-form-label">توضیحات:</label>
                                <textarea class="form-control col-sm-7" placeholder="توضیحات ..." name="Explanation"></textarea>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal"> انصراف <i class="fa fa-trash"></i></button>
                        <button type="submit" class="btn btn-secondary">ثبت آیتم <i class="fa fa-check"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </form>

    <form id="ConfirmAllForm">
        <div class="modal" tabindex="-1" role="dialog" id="ConfirmAllModal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Modal title</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" name="TodoID" id="TodoID" />
                        <p>آیا تمام کارهای این دسته بندی تایید شود؟</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal"> انصراف <i class="fa fa-trash"></i></button>
                        <button type="submit" class="btn btn-secondary"> تایید <i class="fa fa-check"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <form id="ConfirmAllToIncludeInReportForm" action="/Task/ChangeTodoStatus" method="post">
        <div class="modal" tabindex="-1" role="dialog" id="ConfirmAllToIncludeInReportModal">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Modal title</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" name="TodoID" id="TodoID" />
                        <p>آیا تمام کارهای در دسته بندی تایید شود؟</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal"> خیر <i class="fa fa-trash"></i></button>
                        <button type="submit" class="btn btn-secondary"> بله <i class="fa fa-check"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

@section scripts
{
    <script src="~/lib/Chart.js/Chart.min.js"></script>
    <script src="~/lib/Chart.js/chartjs-plugin-datalabels.js"></script>

    <script>
        function openConfirmModal() {

        }
        var defaults = {
            global: {
                // example font
                defaultFontFamily: 'IRANSans'
            }
        };

        /////////
        var daysInMonth = [];
        var petitionNumbers = [];
        var petResult;

        function showChart() {
            daysInMonth = petResult.days;
            petitionNumbers = petResult.pets;
            console.log(daysInMonth);
            console.log(petitionNumbers);

            let popCanvasName = $('#barChart').get(0).getContext('2d');

            var barChartData = {
                labels: daysInMonth,
                datasets: [
                    {
                        label: 'تعداد عریضه‌های روزانه',
                        backgroundColor: '#f56954',
                        borderColor: '#f56954',
                        pointRadius: false,
                        pointColor: '#3b8bba',
                        pointStrokeColor: '#f56954',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: '#f56954',
                        data: petitionNumbers
                    }
                ]
            }

            var barChartOptions = {
                responsive: true,
                plugins: {
                    // Change options for ALL labels of THIS CHART
                    datalabels: {
                        color: '#fff',
                        anchor: 'center',
                        align: 'right',
                        clamp: true,
                    }
                },
                legend: {
                    display: true,
                    labels: {
                        fontFamily: 'IRANSans'
                    },
                    reverse: true,
                    rtl: true,
                    textDirection: 'rtl'
                },
                scales: {
                    xAxes: [{
                        ticks: {
                            reverse: true,
                            fontFamily: "IRANSans",
                        }
                    }],
                    yAxes: [{
                        display: true,
                        position: 'right',
                        ticks: {
                            beginAtZero: true
                        }
                    }],
                },
                tooltips: {
                    titleFontFamily: 'IRANSans',
                    titleAlign: 'right',
                    bodyAlign: 'right',
                    bodyFontFamily: 'IRANSans'
                },
                maintainAspectRatio: false,
                datasetFill: false
            }

            var barChartName = new Chart(popCanvasName, {
                type: 'bar',
                plugins: [{
                    ChartDataLabels
                }],
                data: barChartData,
                options: barChartOptions,
                defaults: defaults
            });
        }
        function getChartData() {
            return fetch('/Petitions/Report/DailyPetitions',
                {
                    method: 'get',
                    headers: {
                        'Content-Type': 'application/json;charset=UTF-8'
                    }
                })
                .then(function (response) {
                    if (response.ok) {
                        return response.text();
                    } else {
                        throw Error('Response Not OK');
                    }
                })
                .then(function (text) {
                    try {
                        return JSON.parse(text);
                    } catch (err) {
                        throw Error('Method Not Found');
                    }
                })
                .then(function (responseJSON) {
                    petResult = responseJSON;
                    showChart();
                })
        }
                //getChartData();
    </script>
}

